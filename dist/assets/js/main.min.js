function initializeMobileMenu(){const e=document.getElementById("mobile-menu-button"),t=document.getElementById("mobile-menu-close-button"),n=document.getElementById("mobile-menu-overlay");if(!e||!t||!n)return;const o=n.querySelectorAll("a[href], button"),i=o[0],r=o[o.length-1],a=e=>{"Tab"===e.key&&(e.shiftKey?document.activeElement===i&&(r.focus(),e.preventDefault()):document.activeElement===r&&(i.focus(),e.preventDefault()))},c=()=>{n.classList.add("hidden"),n.setAttribute("aria-hidden","true"),document.body.style.overflow="",e.focus(),document.removeEventListener("keydown",a)};e.addEventListener("click",()=>{n.classList.remove("hidden"),n.setAttribute("aria-hidden","false"),document.body.style.overflow="hidden",t.focus(),document.addEventListener("keydown",a)}),t.addEventListener("click",c),n.querySelectorAll(".nav-link-mobile").forEach(e=>{e.addEventListener("click",c)}),document.addEventListener("keydown",e=>{"Escape"!==e.key||n.classList.contains("hidden")||c()})}function setActiveNavLink(){const e=window.location.pathname.split("/").pop()||"index.html";setTimeout(()=>{document.querySelectorAll(".nav-link, .nav-link-mobile").forEach(t=>{t.getAttribute("href")===e?t.setAttribute("aria-current","page"):t.removeAttribute("aria-current")})},0)}function setupPageTransitions(){const e=window.location.pathname.split("/").pop()||"index.html";document.body.addEventListener("click",function(t){const n=t.target.closest("a[href]");if(n){if(!n.href||n.href.includes("#")||!n.href.startsWith(window.location.origin))return;if(n.hasAttribute("download")||"_blank"===n.target)return;(new URL(n.href).pathname.split("/").pop()||"index.html")!==e&&(t.preventDefault(),document.body.classList.add("slide-out"),setTimeout(()=>{window.location.href=n.href},500))}})}function setupPhoneObfuscation(e,t,n=""){const o=document.getElementById(e),i=document.getElementById(t);if(!o||!i)return;i.textContent;const r=atob("KzM0IDYzNSA5NDUgNzc5");o.addEventListener("click",function e(t){t.preventDefault(),i.textContent=`${n}${r}`.trim(),o.href=`tel:${r.replace(/\s/g,"")}`,o.removeEventListener("click",e)})}function setupPrintButton(){const e=document.getElementById("print-button");if(!e)return;e.addEventListener("click",()=>window.print());const t=document.createElement("button");t.id="home-button",t.className="bg-slate-500 text-white font-bold py-2 px-4 rounded-lg hover:bg-slate-600 transition-colors duration-300 shadow-lg transform hover:scale-105 ml-4",t.innerHTML="🏠 Volver a la página principal",t.addEventListener("click",()=>window.location.href="index.html"),e.insertAdjacentElement("afterend",t)}function setupScrollAnimations(){const e=document.querySelectorAll(".animate-on-scroll");if(!e.length)return;const t=new IntersectionObserver((e,t)=>{e.forEach((e,n)=>{e.isIntersecting&&(setTimeout(()=>{e.target.classList.add("is-visible")},100*n),t.unobserve(e.target))})},{threshold:.1});e.forEach(e=>{t.observe(e)})}function setupFormValidation(){const e=document.querySelector('form[action*="formsubmit.co"]');if(!e)return;const t=e.querySelectorAll("input[required], textarea[required]"),n=(e,t)=>{const n=document.getElementById(`${e.id}-error`);n&&(n.textContent=t),e.setAttribute("aria-invalid","true"),e.classList.add("input-error")},o=e=>e.validity.valueMissing?(n(e,"Este campo es obligatorio."),!1):e.validity.typeMismatch&&"email"===e.type?(n(e,"Por favor, introduce una dirección de correo válida."),!1):((e=>{const t=document.getElementById(`${e.id}-error`);t&&(t.textContent=""),e.setAttribute("aria-invalid","false"),e.classList.remove("input-error")})(e),!0);e.addEventListener("submit",function(n){n.preventDefault();let i=!0;t.forEach(e=>{o(e)||(i=!1)}),i?grecaptcha.ready(function(){grecaptcha.execute("6LcfUs8rAAAAAErA7-oGbid2aiEL8_iBy7jZ-WYl",{action:"submit"}).then(function(t){e.insertAdjacentHTML("beforeend",`<input type="hidden" name="g-recaptcha-response" value="${t}">`),e.submit()})}):console.log("Formulario no válido. No se enviará.")}),t.forEach(e=>{e.addEventListener("blur",e=>o(e.target)),e.addEventListener("input",e=>{"true"===e.target.getAttribute("aria-invalid")&&o(e.target)})})}async function loadComponent(e,t){try{const n=await fetch(t);if(!n.ok)throw new Error(`Error al cargar ${t}: ${n.statusText}`);const o=await n.text(),i=document.querySelector(e);i&&(i.innerHTML=o)}catch(e){console.error(`No se pudo cargar el componente desde ${t}:`,e)}}document.addEventListener("DOMContentLoaded",()=>{Promise.all([loadComponent("#header","header.html"),loadComponent("#footer","footer.html")]).then(()=>{initializeMobileMenu(),setActiveNavLink()}),setupPageTransitions(),setupPhoneObfuscation("phone-contact","phone-text-contact"),setupPhoneObfuscation("phone-cv","phone-text-cv","📞 "),setupPrintButton(),setupFormValidation(),setupScrollAnimations()});